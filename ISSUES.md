# プロジェクトの問題点

このプロジェクトは、秀丸エディタから楽天AIのWebサイトを操作するためのツールですが、その実装方法に起因するいくつかの問題を抱えています。

## 1. Web UIへの強い依存と脆弱性

このツールの根幹は、WebブラウザのUIを自動操作すること（Webスクレイピングやキー入力のシミュレーション）にあります。

- `HmRakutenAIWeb.mac`内の`textarea[placeholder="質問してみる"]`のようなCSSセレクタや、`HmConvAIWeb.js`内でのキー入力（Ctrl+V, Enter）の送信は、楽天AIのWebサイトのHTML構造やデザインに完全に依存しています。
- サイト側のUIが少しでも変更されると（例：要素のIDやクラス名、プレースホルダーテキストの変更）、ツールは意図通りに動作しなくなり、即座に壊れてしまいます。これは非常に脆弱な設計です。

## 2. 公式APIの不使用

`README.md`にも記載されている通り、本ツールは楽天AIが提供する公式のAPIを利用していません。

- APIを利用しないことで、前述のUI依存の問題が生まれています。
- API経由であれば、UIの変更に影響されず、より安定したデータのやり取りが可能です。また、結果をプログラムで直接取得し、自動処理することも容易になります。

## 3. アーキテクチャの複雑性

このツールは、複数の技術要素が複雑に絡み合って構成されています。

- **秀丸マクロ (.mac)**: 全体の設定と起動
- **JScript (.js)**: メインのロジック、非同期処理、ブラウザ操作
- **C# (.cs)**: クリップボード操作やキー入力シミュレーションのためのCOMコンポーネント
- **外部実行ファイル (.exe)**: クリップボード履歴の管理や、入力フィールドへの直接フォーカス

これらの技術が連携しているため、全体の動作を把握するのが難しく、デバッグや機能追加、メンテナンスのコストが非常に高くなっています。

## 4. プラットフォームへの依存

本ツールは以下の特定の環境に強く依存しています。

- **OS**: Windows (Win32 APIの`keybd_event`やCOMを利用しているため)
- **エディタ**: 秀丸エディタ (マクロ、JScriptのAPIが秀丸専用のため)

これにより、他のOSやエディタのユーザーはこのツールを利用できません。

## 5. 不十分なエラー処理

UIオートメーションは、予期せぬタイミングで失敗する可能性があります（例：ネットワークの遅延でページの読み込みが終わらない、ポップアップが表示されるなど）。

- 現在の実装では、スクリプトが想定しないUIの状態になった場合、キー入力が意図しない場所で実行される危険性があります。
- このような状況を完全に検知し、安全に処理を中断するような堅牢なエラーハンドリングは困難であり、現状の実装では不十分です。

## 6. ビルドされていないバイナリファイルへの依存

リポジトリには、`ClipboardHistMngr.exe`や`HmFocusEachBrowserInputField.exe`といった、コンパイル済みのバイナリファイルが直接含まれています。

- `README.md`にソースコードへのリンクはありますが、このリポジトリ内でビルドプロセスが完結していません。
- 依存するツールのバージョン管理が不透明になり、セキュリティ上の懸念や、将来的な環境構築の妨げになる可能性があります。
